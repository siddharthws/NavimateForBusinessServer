<!-- HTML template for Task Creator Dialog -->
<md-dialog class="dialog-container w-100 h-100">
    <div class="d-flex flex-column h-100 w-100">
        <div class="dialog-header">
            <h4><b>Task Creator</b></h4>
            <hr>
        </div>

        <a href class="ml-2" ng-click="add()">+ Add Task</a>
        <table class="table table-bordered full-flex mt-1" ng-table="">
            <thead>
                <th class="table-col-sm">
                    #
                </th>
                <th class="table-col-lg">
                    Company
                </th>
                <th class="table-col-lg">
                    Rep
                </th>
                <th class="table-col-md">
                    Template
                </th>
                <th class="table-col-sm">
                    Renew In (Days)
                </th>
                <th class="table-col-sm">
                </th>
            </thead>
            <tr ng-repeat="task in tasks">
                <td class="text-center table-col-sm">
                    {{$index + 1}}
                </td>
                <td class="table-col-lg" ng-class="{'has-error': !task.lead && bShowError}">
                    <div class="dropdown full-width full-height">
                        <button class="dropdown-toggle-button d-flex" data-toggle="dropdown">
                            <span class="full-flex">{{task.lead.title}}</span>
                            <img src="/static/images/icon_dropdown.png"/>
                        </button>
                        <div class="dropdown-menu full-width">
                            <input type="text" ng-model="leadFilter.title" placeholder="Search">
                            <button class="dropdown-item" ng-repeat="lead in leads | filter:leadFilter" ng-click="task.lead = lead">{{lead.title}}</button>
                        </div>
                    </div>
                </td>

                <td class="table-col-lg" ng-class="{'has-error': !task.rep && bShowError}">
                    <div class="dropdown full-width full-height">
                        <button class="dropdown-toggle-button d-flex" data-toggle="dropdown">
                            <span class="full-flex">{{task.rep.name}}</span>
                            <img src="/static/images/icon_dropdown.png"/>
                        </button>
                        <div class="dropdown-menu full-width">
                            <input type="text" ng-model="repFilter.name" placeholder="Search">
                            <button class="dropdown-item" ng-repeat="rep in team | filter:repFilter" ng-click="task.rep = rep">{{rep.name}}</button>
                        </div>
                    </div>
                </td>

                <td class="table-col-md" ng-class="{'has-error': !task.template && bShowError}">
                    <div class="dropdown full-width full-height">
                        <button class="dropdown-toggle-button d-flex" data-toggle="dropdown">
                            <span class="full-flex">{{task.template.name}}</span>
                            <img src="/static/images/icon_dropdown.png"/>
                        </button>
                        <div class="dropdown-menu full-width">
                            <input type="text" ng-model="formFilter.name" placeholder="Search">
                            <button class="dropdown-item" ng-repeat="template in formTemplates | filter:formFilter" ng-click="task.template = template">{{template.name}}</button>
                        </div>
                    </div>
                </td>
                <td class="table-col-sm">
                    <input type="number" ng-model="task.period" value="0" class="input-underlined"
                           onkeypress="return (event.charCode == 8 || event.charCode == 0) ? null : event.charCode >= 48 && event.charCode <= 57"/>
                </td>
                <td class="table-col-sm">
                    <input type="button" value="" class="image-button ib-cross" ng-click="remove(task)"/>
                </td>
            </tr>
        </table>

        <div class="d-flex justify-content-end dialog-buttons flex-shrink-0">
            <button class="btn btn-primary" ng-click="create()">Create</button>
            <button class="btn" ng-click="cancel()">Cancel</button>
        </div>
    </div>
</md-dialog>